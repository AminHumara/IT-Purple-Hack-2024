# IT-Purple-Hack-2024
IT Purple Hack | Кейс СБЕР - 2024

# Прогнозирование оттока зарплатного клиента

## Описание задачи
Цель хакатона — разработка алгоритма для прогнозирования вероятности перехода зарплатного клиента в другой банк. Банк может использовать результаты прогноза для оценки потенциальных убытков или предложения более выгодных условий клиентам с высокой вероятностью оттока.

Данные включают информацию о транзакциях, используемых продуктах, взаимодействии с мобильным приложением, терминалах и других факторах.

---

## Решение

### 1. Подготовка данных
- **Загрузка данных**: Данные загружаются из файлов `train.parquet` и `test_sber.parquet`.
- **Предобработка**:
  - Удаление нерелевантных столбцов (например, `id`, `sample_ml_new` и другие).
  - Обработка пропущенных значений: проверка показала отсутствие пропусков.
  - Удаление выбросов с использованием метода `IsolationForest`.

### 2. Моделирование
- **Гиперпараметры моделей**:
  - CatBoost:
    ```python
    params_cat = {
        "n_estimators": 1500,
        "learning_rate": 0.03,
        "depth": 5,
        "l2_leaf_reg": 1,
        "bagging_temperature": 2,
        "random_state": 42,
        'eval_metric': 'AUC',
    }
    ```
  - XGBoost:
    ```python
    best_xgb = {
        'max_depth': 8,
        'learning_rate': 0.028652013256108992,
        'n_estimators': 393,
        'min_child_weight': 3,
        'gamma': 2.689377803691356e-08,
        'subsample': 0.8815574004718228,
        'colsample_bytree': 0.4899073202552123,
        'reg_alpha': 2.1797724563998024e-06,
        'reg_lambda': 9.419756135761821e-08,
    }
    ```
  - MLP (Многослойный перцептрон):
    ```python
    best_mlp = {
        'tol': 1e-06,
        'random_state': 42,
        'n_iter_no_change': 20,
        'max_iter': 2000,
        'learning_rate_init': 0.001,
        'hidden_layer_sizes': np.array([20, 16, 17, 17, 22]),
        'early_stopping': True,
        'alpha': 0.001,
        'activation': 'tanh',
    }
    ```

- **Создание ансамблевой модели**:
  Используется ансамблевый подход на основе голосования (`VotingClassifier`) с тремя моделями: CatBoost, XGBoost и MLP.

### 3. Тестирование
- **Оценка качества**: Метрика ROC-AUC используется для оценки качества моделей.
- **Финальные предсказания**: Вероятности оттока сохранены в файл `sub_finish.csv`.

---

## Заключение
Разработанный алгоритм успешно прогнозирует вероятность оттока зарплатных клиентов, что позволяет банку своевременно реагировать на возможные риски.
### Результат в хакатоне: 10 место.
